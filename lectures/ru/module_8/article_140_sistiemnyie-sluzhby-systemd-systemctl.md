В операционной системе linux, так же как и в Windows, кроме обычных программ, которые могут взаимодействовать с пользователем есть еще один вид программ. Это работающие в фоне службы.Раньше, для управления службами использовались скрипты, каждая служба запускалась в фоновом режиме одна за другой, без возможности параллельного запуска и возвращала свой PID процесса скрипту инициализации, он сохранялся и потом с помощью этого PID можно было проверить работает ли служба и остановить службу linux если это нужно. Все это можно сделать и вручную. Для этого использовалась обертка скрипт service. Рассмотрим основные команды




|  |  |
| --- | --- |
| Запустить службу | sudo service ufw start |
| Остановить службу | sudo service ufw stop |
| Перезапустить службу | sudo service ufw restart |
| Проверить статус службы | sudo service ufw status |


Но потом на смену этому методу пришла новая модель и система инициализации systemd. Система инициализации запускается сразу после загрузки ядра и начинает инициализировать службы, теперь появилась возможность параллельной инициализации, а также зависимостей между службами. Таким образом, теперь можно определить сложное дерево порядка запуска служб. Но мы не будем вникать в подробности создания служб, нас интересует только сам процесс запуска. После запуска systemd собирает весь вывод службы в лог, и следит за ее работой, если служба аварийно завершилась, то автоматически ее перезапускает.  
В Systemd есть специальный инструмент для управления службами в Linux - systemctl. Эта утилита позволяет делать очень много вещей, начиная от перезапуска службы linux и проверки ее состояния, до анализа эффективности загрузки службы. Синтаксис у утилиты такой:


`systemctl опции команда служба служба...`


Служба в Systemd описывается файлом юнита, в нем описано что с ней нужно делать и как себя вести. Существуют такие типы служб:




|  |  |
| --- | --- |
| service | обычная служба, программа |
| target | группа служб |
| automount | точка автоматического монтирования |
| device | файл устройства, генерируется на этапе загрузки |
| mount | точка монтирования |
| path | файл или папка |
| scope | процесс |
| slice | группа системных служб systemd |
| snapshot | сохраненное состояние запущенных служб |
| socket | сокет для взаимодействия между процессами |


Нас будут интересовать только service, и совсем немного target, но мы рассмотрели все остальные, чтобы вы смогли взглянуть на картину немного шире. Основы рассмотрели, теперь будет настройка служб LInux.


**Утилита systemctl**  
В Systemd есть специальный инструмент для управления службами в Linux - systemctl. Эта утилита позволяет делать очень много вещей, начиная от перезапуска службы linux и проверки ее состояния, до анализа эффективности загрузки службы. Синтаксис у утилиты такой:


`$ systemctl опции команда служба служба...`


Опции настраивают поведение программы, подробность вывода, команда - указывает что нужно сделать со службой, а служба, это та самая служба, которой мы собираемся управлять. В некоторых случаях утилита может использоваться без указания команды и службы.




|  |  |
| --- | --- |
| Пример команды | Описание |
| systemctl | Список всех запущенных юнитов |
| systemctl status nginx | Информация о статусе юнита |
| systemctl reload nginx | Релоад конфигурации демона |
| systemctl daemon-reload | Релоад конфигурации systemd (нужно при создании/редактировании юнит файлов): |
| systemctl [start|stop] nginx | Запустить/остановить юнит |
| systemctl [enable|disable] nginx | Включить/выключить автозапуск юнита при загрузке системы |
| systemctl --failed | Список юнитов которые не запустились во время последней загрузки системы |


 

